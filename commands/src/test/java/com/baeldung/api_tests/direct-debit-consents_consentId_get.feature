# ********RoostGPT********

# Test generated by RoostGPT for test MiniProjects using AI Type Open AI and AI Model gpt-4-1106-preview
# 
# Feature file generated for /direct-debit-consents/{consentId}_get for http method type GET 
# RoostTestHash=296226bc11
# 
# 

# ********RoostGPT********
Feature: Real-time Direct Debit Consent Setup

Background:
  * def urlBase = karate.properties['url.base'] || 'http://localhost:8080'
  * url urlBase

Scenario Outline: Retrieve direct debit consent with valid consentId
  Given path 'direct-debit-consents', '<consentId>'
  And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
  And header x-fapi-auth-date = '<x-fapi-auth-date>'
  And header x-fapi-customer-ip-address = '<x-fapi-customer-ip-address>'
  And header x-fapi-interaction-id = '<x-fapi-interaction-id>'
  And header Accept-Language = '<Accept-Language>'
  When method GET
  Then status 200
  And match response contains { data: '#object' }
  And match response.data contains { consentId: '#string', creationDate: '#string', status: '#string', statusUpdateDate: '#string', permissions: '#array' }
  And match response.headers contains { 'x-fapi-interaction-id': '#string' }

  Examples:
    | consentId                              | x-fapi-auth-date            | x-fapi-customer-ip-address | x-fapi-interaction-id  | Accept-Language |
    | 7404e99b-1a4d-4b08-b441-c327661527f0   | Sun, 10 Sep 2017 19:43:31 UTC | 169.254.169.254            | unique-correlation-id1 | en-HK           |

Scenario Outline: Retrieve direct debit consent with invalid consentId
  Given path 'direct-debit-consents', '<consentId>'
  And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
  When method GET
  Then status 400
  And match response contains { errors: '#array' }

  Examples:
    | consentId           |
    | invalid-consent-id  |

Scenario Outline: Retrieve direct debit consent without authorization header
  Given path 'direct-debit-consents', '<consentId>'
  When method GET
  Then status 401

  Examples:
    | consentId                              |
    | 7404e99b-1a4d-4b08-b441-c327661527f0   |

Scenario Outline: Retrieve direct debit consent and expect forbidden due to insufficient permissions
  Given path 'direct-debit-consents', '<consentId>'
  And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
  When method GET
  Then status 403

  Examples:
    | consentId                              |
    | 7404e99b-1a4d-4b08-b441-c327661527f0   |

Scenario Outline: Retrieve direct debit consent with unsupported HTTP method
  Given path 'direct-debit-consents', '<consentId>'
  And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
  When method POST
  Then status 405

  Examples:
    | consentId                              |
    | 7404e99b-1a4d-4b08-b441-c327661527f0   |

Scenario Outline: Retrieve direct debit consent with unacceptable content type
  Given path 'direct-debit-consents', '<consentId>'
  And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
  And header Accept = 'application/xml'
  When method GET
  Then status 406

  Examples:
    | consentId                              |
    | 7404e99b-1a4d-4b08-b441-c327661527f0   |

Scenario: Retrieve direct debit consent and server is unavailable
  Given path 'direct-debit-consents', '7404e99b-1a4d-4b08-b441-c327661527f0'
  And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
  When method GET
  Then status 503

Scenario: Retrieve direct debit consent and server gateway times out
  Given path 'direct-debit-consents', '7404e99b-1a4d-4b08-b441-c327661527f0'
  And header Authorization = 'Bearer ' + karate.properties['AUTH_TOKEN']
  When method GET
  Then status 504
