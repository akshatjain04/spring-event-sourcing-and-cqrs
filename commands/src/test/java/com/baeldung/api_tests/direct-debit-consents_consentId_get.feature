# ********RoostGPT********

# Test generated by RoostGPT for test MiniProjects using AI Type Open AI and AI Model gpt-4-1106-preview
# 
# Feature file generated for /direct-debit-consents/{consentId}_get for http method type GET 
# RoostTestHash=296226bc11
# 
# 

# ********RoostGPT********
Feature: Real-time Direct Debit Consent Setup

Background:
  * def urlBase = karate.properties['url.base'] || 'http://localhost:8080'
  * url urlBase
  * def authToken = karate.properties['AUTH_TOKEN']

Scenario Outline: Retrieve direct-debit consent resource with valid consentId
  Given path 'direct-debit-consents', <consentId>
  And header Authorization = 'Bearer ' + authToken
  And header x-fapi-auth-date = <x-fapi-auth-date>
  And header x-fapi-customer-ip-address = <x-fapi-customer-ip-address>
  And header x-fapi-interaction-id = <x-fapi-interaction-id>
  And header Accept-Language = <Accept-Language>
  When method GET
  Then status 200
  And match response contains { data: '#object' }
  And match response.data.consentId == <consentId>
  And match response.data.permissions contains only ['RealTimeDirectDebitSetup', 'RealTimeDirectDebitOtpConfirmation', 'RealTimeDirectDebitOtpRegeneration', 'RealTimeDirectDebitStatusAuthorisations', 'RealTimeDirectDebitInstructions', 'RealTimeDirectDebitStatusInstructions', 'RealTimeDirectDebitReporting']
  And match response.headers['x-fapi-interaction-id'] == <x-fapi-interaction-id>

  Examples:
    | consentId                               | x-fapi-auth-date                  | x-fapi-customer-ip-address | x-fapi-interaction-id    | Accept-Language |
    | '7404e99b-1a4d-4b08-b441-c327661527f0' | 'Sun, 10 Sep 2017 19:43:31 UTC'   | '169.254.169.254'          | 'unique-interaction-id-1' | 'en-HK'         |

Scenario: Attempt to retrieve direct-debit consent resource with invalid consentId
  Given path 'direct-debit-consents/invalid-consent-id'
  And header Authorization = 'Bearer ' + authToken
  And header x-fapi-auth-date = 'Sun, 10 Sep 2017 19:43:31 UTC'
  And header x-fapi-customer-ip-address = '169.254.169.254'
  And header x-fapi-interaction-id = 'unique-interaction-id-2'
  And header Accept-Language = 'en-HK'
  When method GET
  Then status 400
  And match response.errors[*].code contains 'OB.Field.Invalid'

Scenario: Retrieve direct-debit consent resource without authorization header
  Given path 'direct-debit-consents/7404e99b-1a4d-4b08-b441-c327661527f0'
  And header x-fapi-auth-date = 'Sun, 10 Sep 2017 19:43:31 UTC'
  And header x-fapi-customer-ip-address = '169.254.169.254'
  And header x-fapi-interaction-id = 'unique-interaction-id-3'
  And header Accept-Language = 'en-HK'
  When method GET
  Then status 401

Scenario: Retrieve direct-debit consent resource with unsupported Accept-Language
  Given path 'direct-debit-consents/7404e99b-1a4d-4b08-b441-c327661527f0'
  And header Authorization = 'Bearer ' + authToken
  And header x-fapi-auth-date = 'Sun, 10 Sep 2017 19:43:31 UTC'
  And header x-fapi-customer-ip-address = '169.254.169.254'
  And header x-fapi-interaction-id = 'unique-interaction-id-4'
  And header Accept-Language = 'fr-FR'
  When method GET
  Then status 406
