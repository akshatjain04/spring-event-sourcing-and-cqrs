# ********RoostGPT********

# Test generated by RoostGPT for test MiniProjects using AI Type Open AI and AI Model gpt-4-1106-preview
# 
# Feature file generated for /setup_post for http method type POST 
# RoostTestHash=fac6817e1a
# 
# 

# ********RoostGPT********
Feature: Direct Debit Setup API

Background:
  * def urlBase = karate.properties['url.base'] || karate.get('urlBase', 'http://localhost:8080')
  * url urlBase
  * def bearerToken = karate.properties['AUTH_TOKEN']

Scenario Outline: Setup Direct Debit with valid request body and headers
  Given path '/setup'
  And request
    """
    <requestBody>
    """
  And header Authorization = 'Bearer ' + bearerToken
  And header x-idempotency-key = <xIdempotencyKey>
  And header x-fapi-customer-ip-address = <customerIpAddress>
  And header x-fapi-auth-date = <authDate>
  And header x-fapi-interaction-id = <interactionId>
  When method POST
  Then status 201
  And match response contains { processResult: #object }
  And match response.processResult.responseCode == '00'
  And match response contains { mandateIdentification: #string }
  
  Examples:
    | requestBody                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | xIdempotencyKey | customerIpAddress | authDate                  | interactionId                       |
    | { "merchantRequestIdentification": "ABC123", "creditorReference": "XYZ987", "debtorName": "John Doe", "debtorAccount": { "bankCode": "001", "accountIdentification": "123456789", "currency": "USD", "accountSchemeName": "BBAN", "accountSubType": "CACC" }, "creditorName": "Jane Doe", "creditorAccount": { "bankCode": "002", "accountIdentification": "987654321", "currency": "USD", "accountSchemeName": "BBAN", "accountSubType": "SACC" }, "debtorPrivateIdentification": "A123456(1)", "debtorPrivateIdentificationSchemeName": "CCPT", "maximumAmountCurrency": "USD", "maximumAmount": "1000", "occurrences": { "frequencyType": "MNTH", "durationToDate": "2025-12-31" } } | 'LbGpjj8KaH5wrEfg' | '198.51.100.1'       | 'Sun, 10 Sep 2017 19:43:31 UTC' | '550e8400-e29b-41d4-a716-446655440000' |

Scenario Outline: Setup Direct Debit with invalid request body and headers
  Given path '/setup'
  And request
    """
    <requestBody>
    """
  And header Authorization = 'Bearer ' + bearerToken
  And header x-idempotency-key = <xIdempotencyKey>
  And header x-fapi-customer-ip-address = <customerIpAddress>
  And header x-fapi-auth-date = <authDate>
  And header x-fapi-interaction-id = <interactionId>
  When method POST
  Then status 400
  And match response contains { id: #string }
  And match response.errors[*].code == '#regex [OB.]+'
  
  Examples:
    | requestBody                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | xIdempotencyKey | customerIpAddress | authDate                  | interactionId                       |
    | { "merchantRequestIdentification": "", "creditorReference": "XYZ987", "debtorName": "John Doe", "debtorAccount": { "bankCode": "001", "accountIdentification": "123456789", "currency": "USD", "accountSchemeName": "BBAN", "accountSubType": "CACC" }, "creditorName": "Jane Doe", "creditorAccount": { "bankCode": "002", "accountIdentification": "987654321", "currency": "USD", "accountSchemeName": "BBAN", "accountSubType": "SACC" }, "debtorPrivateIdentification": "A123456(1)", "debtorPrivateIdentificationSchemeName": "CCPT", "maximumAmountCurrency": "USD", "maximumAmount": "1000", "occurrences": { "frequencyType": "MNTH", "durationToDate": "2025-12-31" } } | 'LbGpjj8KaH5wrEfg' | '198.51.100.1'       | 'Sun, 10 Sep 2017 19:43:31 UTC' | '550e8400-e29b-41d4-a716-446655440000' |
